PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H

ORG 1000H
CHAR DB ?

ORG 3000H
A:
MOV BX, OFFSET CHAR
MOV [BX], AL
MOV AL, 1
INT 7
RET

B:
IN AL, PA
AND AL, 128
CMP AL, 10000000B
JNZ FIN
IN AL, PB
NOT AL
OUT PB, AL
FIN:RET

C:
IN AL, PA
CMP AL, 0
JZ FIN2
MOV AL, 0
OUT PB, AL
MOV AH, 1
FIN2:RET

ORG 2000H
MOV AL, 0
OUT CB, AL
MOV AL, 0FFH
OUT CA, AL
LOOP:
IN AL, PA  
CALL A
CALL B
CALL C
CMP AH, 1
JZ FINALIZAR
JMP LOOP
FINALIZAR: INT 0
END