CONT EQU 10H
COMP EQU 11H
EOI EQU 20H
IMR EQU 21H
INT0 EQU 24H
INT1 EQU 25H
ID_TIM EQU 15
ID_F10 EQU 20

ORG 80
IP_F10 DW SUBR_F10
ORG 60
IP_SUBR DW SUBR_CLK

ORG 1000H
NUM DB ?

ORG 2000H
CLI
MOV AL, 0FEH
OUT IMR, AL
MOV AL, ID_F10
OUT INT0, AL
STI
LOOP:
CMP AH, 1
JZ CONFIG_CLK
JMP LOOP
CONFIG_CLK:
CLI
MOV AL, 0FDH
OUT IMR, AL
MOV AL, ID_TIM
OUT INT1, AL
MOV BX, OFFSET NUM
INT 6
MOV AH, [BX]
MOV AL, 0
OUT CONT, AL
MOV AL, 1
OUT COMP, AL
STI
LOOP_CLK:
MOV AL, 1
MOV AH, [BX]
CMP AH, 2Fh
JZ FIN
JMP LOOP_CLK
FIN: INT 0
ORG 3000H
SUBR_F10:
MOV AL, 0FDH
OUT IMR, AL
MOV AL, EOI
OUT EOI, AL
MOV AH, 1
IRET

SUBR_CLK:
INT 7
DEC AH
MOV [BX], AH
MOV AL, 0
OUT CONT, AL
MOV AL, EOI
OUT EOI, AL
IRET
END